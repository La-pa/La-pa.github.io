---
title: 无监督学习
tags: [数学建模, 机器学习, 数据处理]
categories: 数学建模
date: 2023-03-01 19:20:00
---
## K-means算法
### 代码
```python
from sklearn.cluster import KMeans
km = KMeans(n_clusters=3)
km.fit(data)
y_predict = km.predict(data)
y_predict
```
### 数据可视化
```python
import matplotlib.pyplot as plt
colors = ['red', 'green', 'blue', 'purple', 'orange', 'yellow']
for i in range(k):
    plt.scatter(X[y_predict == i, 0], X[y_predict == i, 1], c=colors[i], label='Cluster %d' % i)
plt.scatter(km.cluster_centers_[:, 0], km.cluster_centers_[:, 1], s=100, c='black', label='Centroids')
plt.title('KMeans Clustering')
plt.legend()
plt.show()
```
### 模型评价
#### 手肘法
```python
# 手肘法
from sklearn.datasets import load_iris
from sklearn.cluster import KMeans
import matplotlib.pyplot as plt

# SSE(sum of the squared errors，误差平方和)
SSE = []  # 存放每次结果的误差平方和
for k in range(1,9):
    estimator = KMeans(n_clusters=k)  # 构造聚类器
    estimator.fit(data)
    SSE.append(estimator.inertia_) # estimator.inertia_获取聚类准则的总和
X = range(1,9)
plt.xlabel('k')
plt.ylabel('SSE')
plt.plot(X,SSE,'o-')
plt.show()
```
#### 轮廓系数
```python
scores = []
from sklearn.metrics import silhouette_score
for k in range(2, 9):
    km = KMeans(k)
    km.fit(data)
    y_predict = km.predict(data)
    scores.append(silhouette_score(data, y_predict))
x = range(2,9)
plt.figure()
plt.xlabel('k')
plt.ylabel('score')
plt.plot(x, scores, 'o-')
plt.show()
```
